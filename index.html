<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>GoodReads Books Scatter Plots</title>
<script src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>
<style>
body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji";max-width:1200px;margin:auto;padding:1rem 2rem;}
.grid{display:grid;grid-template-columns:repeat(3,1fr);gap:1rem;}
.plot{box-shadow:0 2px 6px rgba(0,0,0,.05);}
@media (max-width:800px){.grid{grid-template-columns:1fr;}}
footer{margin-top:1rem;font-size:0.8rem;text-align:center;color:#555;}
</style>
</head>
<body>
<h1>GoodReads Books</h1>
<div class="grid">
  <div id="plotA" class="plot"></div>
  <div id="plotB" class="plot"></div>
  <div id="plotC" class="plot"></div>
</div>
<footer>Data from Goodreads &middot; <a href="https://github.com" target="_blank">Repository</a></footer>
<script>
const STATS={A:"\u03c1=0.08, p=0.00e+00",B:"\u03c1=0.09, p=0.00e+00",C:"\u03c1=-0.17, p=0.00e+00"};
fetch('books_trimmed.json').then(r=>r.json()).then(data=>{
  const plots=[
    {id:'plotA',x:'tr',y:'rt',name:'Total Ratings vs Rating',xopts:{type:'log'},stat:STATS.A,xlab:'totalratings'},
    {id:'plotB',x:'pg',y:'rt',name:'Pages vs Rating',stat:STATS.B,xlab:'pages'},
    {id:'plotC',x:'rr',y:'rt',name:'Review Rate vs Rating',stat:STATS.C,xlab:'review_rate'}
  ];
  plots.forEach(p=>{
    const trace={
      x:data.map(d=>d[p.x]),
      y:data.map(d=>d[p.y]),
      mode:'markers',
      type:'scattergl',
      text:data.map(d=>`${d.t}<br>${d.au}`),
      hovertemplate:`%{text}<br>${p.xlab}: %{x}<br>${p.y}: %{y}<extra></extra>`,
      marker:{color:data.map(d=>d.rt),colorscale:'Viridis',opacity:0.4}
    };
    const layout={
      margin:{l:40,r:20,t:40,b:40},
      xaxis:{title:p.xlab,...p.xopts},
      yaxis:{title:'rating'},
      title:`${p.name} (${p.stat})`,
      height:350
    };
    Plotly.newPlot(p.id,[trace],layout,{responsive:true});
  });
});
</script>
</body>
</html>
